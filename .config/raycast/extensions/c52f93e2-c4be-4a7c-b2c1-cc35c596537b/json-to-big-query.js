"use strict";var pe=Object.create;var R=Object.defineProperty;var ce=Object.getOwnPropertyDescriptor;var le=Object.getOwnPropertyNames;var me=Object.getPrototypeOf,de=Object.prototype.hasOwnProperty;var T=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),ge=(r,e)=>{for(var t in e)R(r,t,{get:e[t],enumerable:!0})},G=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of le(e))!de.call(r,a)&&a!==t&&R(r,a,{get:()=>e[a],enumerable:!(n=ce(e,a))||n.enumerable});return r};var ve=(r,e,t)=>(t=r!=null?pe(me(r)):{},G(e||!r||!r.__esModule?R(t,"default",{value:r,enumerable:!0}):t,r)),Te=r=>G(R({},"__esModule",{value:!0}),r);var N=T((U,X)=>{(function(r){typeof U=="object"?X.exports=r():typeof define=="function"&&define.amd&&define(r)})(function(){var r=function(){var i=[Object,Function,Array,String,Boolean,Number,Date,RegExp,Error],f=i.length;return function(p){for(var d=0;d<f;d++)if(i[d]===p)return!0;return!1}}(),e=function(){var i={}.toString;return function(f){var p=i.call(f).slice(8,-1);if(f==null)return p.toLowerCase();var d=t(f);return d&&!r(d)?d.name:p}}();function t(i){return i==null?i:i.constructor}function n(i,f){var p=t(f)===String?e:t;return p(i)===f}function a(i,f){return i instanceof f}function s(i,f){return a(i.prototype,f)}function u(i,f){if(!n(f,Array))throw"Second argument to .any() should be array";for(var p=0;p<f.length;p++){var d=f[p];if(n(i,d))return!0}return!1}var o=function(i,f){return arguments.length==1?t(i):n(f,Array)?u(i,f):n(i,f)};return o.instance=a,o.string=e,o.of=t,o.is=n,o.any=u,o.extension=s,o})});var O=T(A=>{var ye=/\d{4}-\d{2}-\d{2}/;A.isNumber=function(r){return typeof r=="number"||Object.prototype.toString.call(r)==="[object Number]"};A.isDate=function(r){return new Date(r).toString()!=="Invalid Date"&&!isNaN(new Date(r))};A.isTimestamp=function(r){return r.length>18&&!isNaN(new Date(r).getTime())};A.isDateString=function(r){return r.match(ye)};A.arrayLastItem=function(r){return r[r.length-1]}});var Y=T((Ce,K)=>{var he=N(),be=O();K.exports=function r(e,t){t=t||{};for(var n in e){var a=e[n],s=he.string(a).toLowerCase();s==="undefined"&&(s="null"),s==="string"&&be.isDate(a)&&(s="date"),s!=="object"?t[n]={type:s}:(t[n]=r(e[n]),t[n].type=s)}return t}});var H=T((je,z)=>{var J=N(),Ee=O();function $(r){switch(r){case"array":return"Array";case"buffer":return"Buffer";case"boolean":return"Boolean";case"date":return"Date";case"number":return"Number";case"string":return"String";case"objectid":return"ObjectId";case"null":case"undefined":case"regexp":default:return"Mixed"}}z.exports=function r(e,n){var n=n||{};for(var a in e){var s=e[a],u=null,o=null,i=null;if(s instanceof Buffer&&(i="buffer"),s!=null&&typeof s.toString<"u"&&s.toString().match(/^[0-9a-fA-F]{24}$/)&&(i="objectid"),i||(i=J.string(s).toLowerCase()),i==="string"&&Ee.isDate(s)&&(i="date"),i==="object")n[a]=r(e[a]);else{if(i==="undefined"&&(i="null"),i==="array"&&s.length){u=i,i=void 0;for(var f=0,p=s.length;f<p;f++)if(o=J.string(s[f]).toLowerCase(),i&&o!==i){i="mixed";break}else i=o}u&&u==="array"?n[a]={type:[$(i)]}:n[a]={type:$(i)}}}return n}});var k=T((we,Z)=>{var Q=O();function Ne(r){return Array.isArray(r)?"REPEATED":"NULLABLE"}function V(r){if(Array.isArray(r))return V(r[0]);if(r instanceof Date)return"TIMESTAMP";if(typeof r=="object")return"RECORD";if(typeof r=="boolean")return"BOOLEAN";if(typeof r=="string"){if(Q.isDateString(r))return"DATE";if(Q.isTimestamp(r))return"TIMESTAMP"}return isNaN(r)?"STRING":Number.isInteger(parseFloat(r))?"INTEGER":"FLOAT"}function W(r){return Object.keys(r).map(function(e){var t=r[e],n={name:e,type:V(r[e]),mode:Ne(r[e])};return n.type==="RECORD"&&(n.fields=W(n.mode==="REPEATED"?t[0]:t)),n})}Z.exports=function(e){return W(e)}});var re=T((xe,ee)=>{var Ae=N(),j=O(),w={boolean:"BOOLEAN",string:"TEXT",number:"INT",date:"DATE",timestamp:"TIMESTAMP",regexp:"TEXT",undefined:"TEXT",null:"TEXT"},h={create:function(r){return["CREATE TABLE ",r," ("].join("")},close:function(){return");"},id:function(r,e){return["  ",r,"_id ",e,","].join("")},property:function(r,e){return["  ",r," ",e,","].join("")},primary:function(r){return["  PRIMARY KEY (",r,"),"].join("")},foreign:function(r,e,t){return["  FOREIGN KEY (",r,") REFERENCES ",e,"(",t,"),"].join("")}};function S(r,e){var t=e.tableName,n=e.parentTableName,a=e.parentTableId,s=e.parentTableIdType,u=Object.keys(r),o=[],i=[],f=null,p="string";o.push(h.create(t)),n&&o.push(h.property(n+"_"+a,w[s]));for(var d,l=0;l<u.length;l++)(u[l].toLowerCase()==="id"||u[l].toLowerCase().indexOf("_id")>-1)&&(d=u[l],r[d]=r[u[l]],u[l]=d,f=u[l],p=typeof r[u[l]]);f||(f="id",p=s||p,o.push(h.property(f,w[p])));for(var m,g,c,l=0;l<u.length;l++)if(m=u[l],g=r[m],c=g instanceof Date?"date":Ae.string(g).toLowerCase(),c!=="undefined"&&(c=j.isTimestamp(g)?"timestamp":c),c!=="function"){if(c==="object"&&!g.length){i.push(""),i.push(S(g,{parentTableName:t,parentTableId:f,parentTableIdType:p,tableName:t+"_"+m}).join(`
`));continue}if(c==="object"||c==="array"){if(typeof g[0]=="object"){i.push(""),i.push(S(g[0],{parentTableName:t,parentTableId:f,parentTableIdType:p,tableName:t+"_"+m}).join(`
`));continue}i.push(""),i.push(S({value:typeof g[0]},{parentTableName:t,parentTableId:f,parentTableIdType:p,tableName:t+"_"+m}).join(`
`));continue}o.push(h.property(m,w[c]))}return o.push(h.primary(f)),n&&o.push(h.foreign(n+"_id",n,a)),o[o.length-1]=j.arrayLastItem(o).substr(0,j.arrayLastItem(o).length-1),o.push(h.close()),o.concat(i)}ee.exports=function(e,t){return typeof e!="string"&&(t=e,e="generic"),S(t,{tableName:e}).join(`
`)}});var te=T((_e,ne)=>{var q=N(),Oe="http://json-schema.org/draft-04/schema#";function x(r){var e=q.string(r).toLowerCase();return e==="date"?"date-time":null}function D(r){var e=q.string(r).toLowerCase();return e==="date"||e==="regexp"||e==="function"?"string":e}function De(r,e,t){r=Object.keys(r),e=Object.keys(e),t=t||[];for(var n,a,s,u=0,o=e.length;u<o;u++)n=e[u],s=r.indexOf(n),a=t.indexOf(n),s===-1?a!==-1&&t.splice(a,1):a===-1&&t.push(n);return t}function _(r,e,t){var n,a,s;t&&e?e={items:e}:(e=e||{},e.type=D(r),e.items=e.items||{},s=e.items.type||null);for(var u=0,o=r.length;u<o;u++){var i=D(r[u]),f=x(r[u]);if(s&&i!==s){e.items.oneOf=[],a=!0;break}else s=i,n=f}if(!a&&s?(e.items.type=s,n&&(e.items.format=n)):a&&s!=="object"&&(e.items={oneOf:[{type:s}],required:e.items.required}),typeof e.items.oneOf<"u"||s==="object")for(var p=0,d=r.length;p<d;p++){var l=r[p],m=D(l),g=x(l),c;if(m==="object"?(e.items.properties&&(e.items.required=De(e.items.properties,l,e.items.required)),c=F(l,a?{}:e.items.properties,!0)):m==="array"?c=_(l,a?{}:e.items.properties,!0):(c={},c.type=m,g&&(c.format=g)),a){var v=q.string(l).toLowerCase(),C={};!c.type&&v==="object"&&(C.properties=c,C.type="object",c=C),e.items.oneOf.push(c)}else{if(e.items.type!=="object")continue;e.items.properties=c}}return t?e.items:e}function F(r,e,t){t&&e?e={properties:e}:(e=e||{},e.type=D(r),e.properties=e.properties||{});for(var n in r){var a=r[n],s=D(a),u=x(a);if(s=s==="undefined"?"null":s,s==="object"){e.properties[n]=F(a,e.properties[n]);continue}if(s==="array"){e.properties[n]=_(a,e.properties[n]);continue}if(e.properties[n]){var o=e.properties[n],i=Array.isArray(o.type);i&&o.type.indexOf(s)<0&&o.type.push(s),!i&&o.type!==s&&(o.type=[o.type,s]);continue}e.properties[n]={},e.properties[n].type=s,u&&(e.properties[n].format=u)}return t?e.properties:e}ne.exports=function(e,t){var n,a={$schema:Oe};return typeof e!="string"?(t=e,e=void 0):a.title=e,a.type=q.string(t).toLowerCase(),a.type==="object"&&(n=F(t),a.type=n.type,a.properties=n.properties),a.type==="array"&&(n=_(t),a.type=n.type,a.items=n.items,a.title&&(a.items.title=a.title,a.title+=" Set")),a}});var ae=T((Fe,ie)=>{var Ie=N(),M=O(),B={boolean:"String",string:"String",number:"Int32",date:"Date",timestamp:"DateTime",object:"Nested",regexp:"String",undefined:"String",null:"String"},I={create:function(r){return["CREATE TABLE ",r," ("].join("")},close:function(r,e){return e?[") ENGINE = MergeTree(",e,", (",r,", ",e,"), 8192);"].join(""):[") ENGINE = Memory;"].join("")},id:function(r,e){return["  ",r,"_id ",e,","].join("")},property:function(r,e){return["  ",r," ",e,","].join("")}};function P(r,e,t){var n=e.tableName,a=e.parentTableName,s=e.parentTableId,u=e.parentTableIdType,o=Object.keys(r),i=[],f=[],p=null,d="string";i.push(I.create(n)),a&&i.push(I.property(a+"_"+s,B[u]));for(var l,m=0;m<o.length;m++)(o[m].toLowerCase()==="id"||o[m].toLowerCase().indexOf("_id")>-1)&&(l=o[m],r[l]=r[o[m]],o[m]=l,p=o[m],d=typeof r[o[m]]);p||(p="id",d=u||d,i.push(I.property(p,B[d])));for(var g,c,v,m=0;m<o.length;m++){if(g=o[m],c=r[g],v=c instanceof Date?"date":Ie.string(c).toLowerCase(),v=="date"&&!t)var t=g;if(v!=="undefined"&&(v=M.isTimestamp(c)?"timestamp":v),v!=="function"){if(v==="object"&&!c.length){f.push(""),f.push(P(c,{parentTableName:n,parentTableId:p,parentTableIdType:d,tableName:n+"_"+g}).join(""));continue}if(v==="object"||v==="array"){if(typeof c[0]=="object"){f.push(""),f.push(P(c[0],{parentTableName:n,parentTableId:p,parentTableIdType:d,tableName:n+"_"+g}).join(""));continue}f.push(""),f.push(P({value:typeof c[0]},{parentTableName:n,parentTableId:p,parentTableIdType:d,tableName:n+"_"+g}).join(""));continue}i.push(I.property(g,B[v]))}}return i[i.length-1]=M.arrayLastItem(i).substr(0,M.arrayLastItem(i).length-1),i.push(I.close(p,t)),i.concat(f)}ie.exports=function(e,t,n){return typeof e!="string"&&(t=e,e="generic"),n||(n=null),P(t,{tableName:e},n).join("")}});var se=T(b=>{b.generic=Y();b.mongoose=H();b.bigquery=k();b.mysql=re();b.json=te();b.clickhouse=ae()});var Re={};ge(Re,{default:()=>Le});module.exports=Te(Re);var ue=ve(se());var L=require("react"),oe=({transformDeps:r=[],transform:e})=>{let[t,n]=(0,L.useState)(""),[a,s]=(0,L.useState)("");return(0,L.useEffect)(()=>{(async()=>{try{s(await e(t))}catch{s("Invalid input")}})()},[t,...r]),{inputProps:{value:t,onChange:n,id:"input",title:"Input",autoFocus:!0},outputProps:{value:a,id:"output",title:"Output",onChange:()=>{}}}};var y=require("@raycast/api"),E=require("react/jsx-runtime");function fe({inputProps:r,outputProps:e,actions:t,options:n,output:a,input:s}){return(0,E.jsxs)(y.Form,{actions:t||(0,E.jsxs)(y.ActionPanel,{children:[(0,E.jsx)(y.Action.CopyToClipboard,{content:e.value}),(0,E.jsx)(y.Action.Paste,{content:e.value})]}),children:[s||(0,E.jsx)(y.Form.TextArea,{...r}),n,a||(0,E.jsx)(y.Form.TextArea,{...e})]})}var Se=require("react/jsx-runtime"),Le=()=>{let r=oe({transform:async e=>JSON.stringify((0,ue.bigquery)(JSON.parse(e)),null,2)});return(0,Se.jsx)(fe,{...r})};0&&(module.exports={});
